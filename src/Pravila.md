На данной вкладке представлены правила анализа уязвимостей, которые применяются для выбранного проекта. В общем случае правила соответствуют определенным на уровне организации (см. раздел `<a href="../aag/pravila_analiza_na_urovne_organizacii.htm" title="Правила анализа на уровне Организации">Правила анализа на уровне Организации`</a> в Руководстве прикладного администратора), но есть возможность изменить или добавить правила в соответствии со спецификой сканируемого приложения. Необходимо отметить, что правила, добавленные непосредственно в проекте, будут применяться только в рамках этого проекта.

![](img/image37.png)

#### Переопределение правил анализа

На странице **Проект** на вкладке **Правила** представлены правила анализа собранных данных для поиска уязвимостей. На этой вкладке возможно добавить, изменить или удалить существующее правило анализа для конкретного проекта. То есть, заданное на этой вкладке новое или измененное правило будет применяться в рамках только этого проекта, а не для всех проектов данной Организации.

#### Описание работы правил анализа

Основная цель применения правил анализа --- модификация системы под особенности своего приложения для эффективной работы по поиску уязвимостей. Каждое приложение и его данные уникальны по формату и содержанию и применение кастомизированных правил анализа позволяет максимально увеличить покрытие системой всех возможных кейсов для поиска уязвимостей для каждого конкретного приложения.
Правила анализа, по которым происходит поиск части уязвимостей, представляют собой набор строк или регулярных выражений, которые необходимо искать в собранных в ходе сканирования приложения данных. Каждое правило определяет, какую строку или регулярное выражение искать, в данных каких модулей и в каком месте/каких форматах данных. Такой подход позволяет значительно сократить количество ложных срабатываний при поиске уязвимостей.
В системе существует два вида правил анализа:

* Внутренние правила поиска уязвимостей, не подлежащие настройке и недоступные пользователю для просмотра и редактирования. Они не представлены на вкладке **Правила**.
* Правила, которые занимаются поиском чувствительной информации. Как раз
они и представлены на вкладке **Правила** и описаны в этом разделе. Эти правила пользователь системы может модифицировать и настроить под работу со своим приложением.
На вкладке **Правила** каждое правило анализа представлено отдельной строкой в левой части экрана. Строка правила имеет следующие поля:
* Индикатор состояния правила. Если в этом поле стоит значок ![](smimg/image15.png), то правило является активным и будет применяться при анализе собранных данных для поиска уязвимостей. Если в этом поле стоит значок <img alt="Picture 140" height="12.3" src="/smimg/image16.png" width="12.3" />, то правило является неактивным и не будет применяться при анализе собранных данных для поиска уязвимостей.
* Имя правила для более удобной навигации.

<p align="center"><img height="610" src="/img/image38.png" width="50%" /></p>

Выбранное правило подсвечивается и в правой части экрана отображаются детали:

* **Имя** --- имя правила для более удобной навигации.
* **Описание** --- описание правила.
* **Строка поиска** --- строка или регулярное выражение для поиска конфиденциальной информации.
* **Модули** --- модули системы, для которых будет применяться данное правило.
* **Место поиска** --- где именно искать необходимую информацию, в каких файлах и форматах данных.

<p align="center"><img height="845" src="/img/image39.png" width="50%" /></p>

Рассмотрим, как работают правила анализа на примере одного из правил.

<p align="center"><img height="1155" src="/img/image41.png" width="100%" /></p>

Это правило анализа в данный момент является активным и называется «Пароль». Оно определяет, что следующие паттерны:

* Регулярные выражения вида **pin(?:\[\_-\]?code)?**.
* Строка **passphrase**.
* Строка **password**.
* Строка **passwd**.
* Строка **paswd**.
Они будут искаться в данных, собранных всеми семнадцатью модулями системы (эти модули были выбраны в поле Модули), в следующих местах (эти значения были выбраны в поле Место поиска):
* Имя XML-тега.
* Имя ключа в паре key=value.
Пользователь имеет возможность сделать неактивным, отредактировать или удалить это правило в случае необходимости.
Для удобства работы с правилами существует возможность выбрать и применить для отображаемых правил фильтр в верхней части экрана по нажатию на кнопку **Фильтр**.

<p align="center"><img height="579" src="/img/image42.png" width="100%" /></p>

В появившемся поле можно выбрать из выпадающих списков одно или несколько значений для фильтрации по параметрам **Модули** и **Место поиска**. Фильтр может быть очищен по нажатию кнопки **Очистить фильтр** справа вверху. При повторном нажатии на кнопку **Фильтр** в левом вернем углу, поле фильтрации будет свернуто.

<p align="center"><img src="/img/image43.png" /></p>

#### Добавление / редактирование правил анализа

Редактирование правил анализа может быть произведено на вкладке **Правила**. Для редактирования выберите необходимое правило в левом окне **Правила**. В правом окне
**Детали** можно изменить и сохранить следующие параметры:

* **Имя** правила для более удобной навигации.
* **Описание** правила анализа (опциональный параметр).
* В поле **Строка поиска** можно задать строку или регулярное выражение для поиска конфиденциальной информации. Для вновь добавляемого регулярного выражения необходимо нажать на кнопку <img alt="Рисунок 69" height="13.6" src="/smimg/image22.png" width="18.1" /> рядом с заголовком «Строка поиска», в появившемся поле **Значение** задать собственно новую строку или регулярное выражение и нажать кнопку **Сохранить**. Все ранее определенные регулярные выражения для данного правила перечислены в окне в списке ниже. Для удаления регулярного выражения нажмите значок <img alt="Picture 117" height="12.0" src="/smimg/image23.png" width="12.0" /> справа в конце поля.
* **Место поиска** --- активные места поиска отмечены значком <img alt="Picture 118" height="14.6" src="/smimg/image24.png" width="15.5" />,
неактивные значком <img alt="Рисунок 78" height="16.1" src="/smimg/image25.png" width="15.4" />. Для изменения необходимо нажать на нужный элемент. Его статус изменится и будет отображено уведомлении об успешном изменении.
* **Модули**, для которых будет применяться данное правило. Любой из модулей сканирования в системе можно выбрать и добавить в правило. Включение и отключение происходит аналогично полю **Место поиска**.
* Для сохранения всех произведенных изменений в регулярном выражении нажмите кнопку **Сохранить** справа.

<p align="center"><img height="414" src="/img/image45.png" width="50%" /></p>

Для добавления нового правила анализа нажмите кнопку **Добавить правило** справа вверху экрана. В появившемся окне **Добавление нового правила** необходимо ввести имя и описание правила и нажать кнопку **Добавить** внизу справа. Добавленное правило будет отображено в списке и доступно для дальнейшего редактирования.

<p align="center"><img height="260" src="/smimg/image27.png" width="50%" /></p>

#### Удаление правил анализа

Удаление правил анализа может быть произведено на вкладке **Правила**. Для редактирования правила нажмите на кнопку **Удалить правило** в правом нижнем углу вкладки.В появившемся окне **Удаление правила** необходимо подтвердить или отменить удаление.

<p align="center"><img  height="167" src="/smimg/image28.png" width="60%" /></p>
